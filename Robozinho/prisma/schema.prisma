datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Member {
  id       Int      @id @default(autoincrement())
  name     String
  user     String   @unique
  age      Int
  password String
  userWtp  String
  phone    String
  role     String   // Define se é "admin" ou "user"
  subRole  String?  // Caso necessário para admins
  points   Int

  // Relacionamento 1:N - Um membro pode ter vários livros
  books    Book[]

  // Relacionamento N:N com Subs (usando tabela intermediária MemberSub)
  subs     MemberSub[]
}

model Book {
  id        Int     @id @default(autoincrement())
  title     String
  memberId  Int?
  wUrl      String

  // Relacionamento com Member (substitui Admin e User)
  member    Member? @relation(fields: [memberId], references: [id])
}

model Sub {
  id    Int    @id @default(autoincrement())
  name  String @unique

  // Relacionamento N:N com Member
  members MemberSub[]
}

// Tabela intermediária para relação N:N entre Member e Sub
model MemberSub {
  memberId Int
  subId    Int

  member Member @relation(fields: [memberId], references: [id])
  sub    Sub    @relation(fields: [subId], references: [id])

  @@id([memberId, subId]) // Chave composta
}
